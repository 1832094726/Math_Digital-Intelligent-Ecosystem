<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>K-12数学教育系统 - 数据库关系可视化演示</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
    <link href="https://unpkg.com/vis-network/styles/vis-network.css" rel="stylesheet" type="text/css" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- 顶部导航 -->
    <header class="header">
        <div class="header-content">
            <div class="logo">
                <i class="fas fa-database"></i>
                <h1>K-12数学教育系统</h1>
                <span class="subtitle">数据库关系可视化演示</span>
            </div>
            <div class="header-controls">
                <div class="view-mode">
                    <button id="overviewBtn" class="btn btn-primary active">
                        <i class="fas fa-eye"></i> 总览视图
                    </button>
                    <button id="moduleBtn" class="btn btn-secondary">
                        <i class="fas fa-layer-group"></i> 模块视图
                    </button>
                    <button id="detailBtn" class="btn btn-secondary">
                        <i class="fas fa-search-plus"></i> 详细视图
                    </button>
                    <button id="apiBtn" class="btn btn-secondary" onclick="window.open('api-visualization.html', '_blank')">
                        <i class="fas fa-code"></i> API视图
                    </button>
                </div>
                <div class="zoom-controls">
                    <button id="zoomIn" class="btn btn-icon">
                        <i class="fas fa-plus"></i>
                    </button>
                    <button id="zoomOut" class="btn btn-icon">
                        <i class="fas fa-minus"></i>
                    </button>
                    <button id="resetView" class="btn btn-icon">
                        <i class="fas fa-home"></i>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- 主要内容区域 -->
    <main class="main-content">
        <!-- 左侧面板 -->
        <aside class="sidebar">
            <div class="panel">
                <h3><i class="fas fa-list"></i> 数据表列表</h3>
                <div class="table-categories">
                    <div class="category" data-category="user">
                        <h4><i class="fas fa-users"></i> 用户权限系统 (3张表)</h4>
                        <ul class="table-list">
                            <li class="table-item" data-table="users">
                                <i class="fas fa-user"></i> users - 用户基础信息
                            </li>
                            <li class="table-item" data-table="user_sessions">
                                <i class="fas fa-clock"></i> user_sessions - 用户会话
                            </li>
                            <li class="table-item" data-table="notifications">
                                <i class="fas fa-bell"></i> notifications - 通知消息
                            </li>
                        </ul>
                    </div>

                    <div class="category" data-category="school">
                        <h4><i class="fas fa-school"></i> 学校组织架构 (6张表)</h4>
                        <ul class="table-list">
                            <li class="table-item" data-table="schools">
                                <i class="fas fa-building"></i> schools - 学校基础信息
                            </li>
                            <li class="table-item" data-table="grades">
                                <i class="fas fa-layer-group"></i> grades - 年级信息
                            </li>
                            <li class="table-item" data-table="classes">
                                <i class="fas fa-users-class"></i> classes - 班级信息
                            </li>
                            <li class="table-item" data-table="class_students">
                                <i class="fas fa-link"></i> class_students - 班级学生关联
                            </li>
                            <li class="table-item" data-table="curriculum_standards">
                                <i class="fas fa-book"></i> curriculum_standards - 课程标准
                            </li>
                            <li class="table-item" data-table="subjects">
                                <i class="fas fa-graduation-cap"></i> subjects - 学科信息
                            </li>
                        </ul>
                    </div>

                    <div class="category" data-category="homework">
                        <h4><i class="fas fa-tasks"></i> 作业管理系统 (8张表)</h4>
                        <ul class="table-list">
                            <li class="table-item" data-table="homeworks">
                                <i class="fas fa-file-alt"></i> homeworks - 作业模板
                            </li>
                            <li class="table-item" data-table="questions">
                                <i class="fas fa-question-circle"></i> questions - 题目信息
                            </li>
                            <li class="table-item" data-table="homework_assignments">
                                <i class="fas fa-share"></i> homework_assignments - 作业分配
                            </li>
                            <li class="table-item" data-table="homework_submissions">
                                <i class="fas fa-upload"></i> homework_submissions - 作业提交
                            </li>
                            <li class="table-item" data-table="homework_progress">
                                <i class="fas fa-chart-line"></i> homework_progress - 答题进度
                            </li>
                            <li class="table-item" data-table="homework_favorites">
                                <i class="fas fa-star"></i> homework_favorites - 作业收藏
                            </li>
                            <li class="table-item" data-table="homework_reminders">
                                <i class="fas fa-alarm-clock"></i> homework_reminders - 作业提醒
                            </li>
                            <li class="table-item" data-table="grading_results">
                                <i class="fas fa-chart-bar"></i> grading_results - 评分结果
                            </li>
                        </ul>
                    </div>

                    <div class="category" data-category="knowledge">
                        <h4><i class="fas fa-brain"></i> 知识图谱系统 (3张表)</h4>
                        <ul class="table-list">
                            <li class="table-item" data-table="knowledge_points">
                                <i class="fas fa-lightbulb"></i> knowledge_points - 知识点
                            </li>
                            <li class="table-item" data-table="knowledge_relationships">
                                <i class="fas fa-project-diagram"></i> knowledge_relationships - 知识关系
                            </li>
                            <li class="table-item" data-table="concept_maps">
                                <i class="fas fa-sitemap"></i> concept_maps - 概念图
                            </li>
                        </ul>
                    </div>

                    <div class="category" data-category="course">
                        <h4><i class="fas fa-book-open"></i> 课程体系 (5张表)</h4>
                        <ul class="table-list">
                            <li class="table-item" data-table="courses">
                                <i class="fas fa-book"></i> courses - 课程信息
                            </li>
                            <li class="table-item" data-table="course_modules">
                                <i class="fas fa-puzzle-piece"></i> course_modules - 课程模块
                            </li>
                            <li class="table-item" data-table="chapters">
                                <i class="fas fa-bookmark"></i> chapters - 章节信息
                            </li>
                            <li class="table-item" data-table="lessons">
                                <i class="fas fa-play-circle"></i> lessons - 课时信息
                            </li>
                            <li class="table-item" data-table="class_schedules">
                                <i class="fas fa-calendar-alt"></i> class_schedules - 课程安排
                            </li>
                        </ul>
                    </div>

                    <div class="category" data-category="learning">
                        <h4><i class="fas fa-route"></i> 学习路径系统 (1张表)</h4>
                        <ul class="table-list">
                            <li class="table-item" data-table="learning_paths">
                                <i class="fas fa-map-marked-alt"></i> learning_paths - 学习路径
                            </li>
                        </ul>
                    </div>

                    <div class="category" data-category="ai_recommendation">
                        <h4><i class="fas fa-robot"></i> AI智能推荐 (3张表)</h4>
                        <ul class="table-list">
                            <li class="table-item" data-table="symbol_recommendations">
                                <i class="fas fa-magic"></i> symbol_recommendations - 符号推荐
                            </li>
                            <li class="table-item" data-table="problem_recommendations">
                                <i class="fas fa-lightbulb"></i> problem_recommendations - 题目推荐
                            </li>
                            <li class="table-item" data-table="learning_path_recommendations">
                                <i class="fas fa-compass"></i> learning_path_recommendations - 路径推荐
                            </li>
                        </ul>
                    </div>

                    <div class="category" data-category="learning_analytics">
                        <h4><i class="fas fa-chart-line"></i> 学习分析系统 (3张表)</h4>
                        <ul class="table-list">
                            <li class="table-item" data-table="learning_behaviors">
                                <i class="fas fa-user-chart"></i> learning_behaviors - 学习行为
                            </li>
                            <li class="table-item" data-table="interaction_logs">
                                <i class="fas fa-mouse-pointer"></i> interaction_logs - 交互日志
                            </li>
                            <li class="table-item" data-table="engagement_metrics">
                                <i class="fas fa-tachometer-alt"></i> engagement_metrics - 参与度指标
                            </li>
                        </ul>
                    </div>

                    <div class="category" data-category="error_analysis">
                        <h4><i class="fas fa-exclamation-triangle"></i> 错误分析系统 (2张表)</h4>
                        <ul class="table-list">
                            <li class="table-item" data-table="error_patterns">
                                <i class="fas fa-bug"></i> error_patterns - 错误模式
                            </li>
                            <li class="table-item" data-table="misconception_analysis">
                                <i class="fas fa-question"></i> misconception_analysis - 误解分析
                            </li>
                        </ul>
                    </div>

                    <div class="category" data-category="adaptive_learning">
                        <h4><i class="fas fa-brain"></i> 自适应学习 (2张表)</h4>
                        <ul class="table-list">
                            <li class="table-item" data-table="adaptive_paths">
                                <i class="fas fa-random"></i> adaptive_paths - 自适应路径
                            </li>
                            <li class="table-item" data-table="mastery_tracking">
                                <i class="fas fa-chart-pie"></i> mastery_tracking - 掌握度跟踪
                            </li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- 表详情面板 -->
            <div class="panel table-details" id="tableDetails" style="display: none;">
                <h3><i class="fas fa-table"></i> 表详情</h3>
                <div id="tableDetailsContent">
                    <!-- 动态内容 -->
                </div>
            </div>
        </aside>

        <!-- 中央可视化区域 -->
        <section class="visualization-area">
            <div class="canvas-container">
                <div id="networkCanvas"></div>
                
                <!-- 加载指示器 -->
                <div class="loading-indicator" id="loadingIndicator">
                    <div class="spinner"></div>
                    <p>正在加载数据库关系图...</p>
                </div>

                <!-- 图例 -->
                <div class="legend">
                    <h4><i class="fas fa-info-circle"></i> 图例</h4>
                    <div class="legend-items">
                        <div class="legend-item">
                            <div class="legend-color user-color"></div>
                            <span>用户权限系统</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color school-color"></div>
                            <span>学校组织架构</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color course-color"></div>
                            <span>课程体系</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color homework-color"></div>
                            <span>作业管理系统</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color learning-color"></div>
                            <span>学习路径系统</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color knowledge-color"></div>
                            <span>知识图谱系统</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color ai-recommendation-color"></div>
                            <span>AI智能推荐</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color learning-analytics-color"></div>
                            <span>学习分析系统</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color error-analysis-color"></div>
                            <span>错误分析系统</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color adaptive-learning-color"></div>
                            <span>自适应学习</span>
                        </div>
                    </div>
                    <div class="legend-relationships">
                        <h5>关系类型</h5>
                        <div class="legend-item">
                            <div class="legend-line one-to-many"></div>
                            <span>一对多 (1:N)</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-line many-to-many"></div>
                            <span>多对多 (N:N)</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-line one-to-one"></div>
                            <span>一对一 (1:1)</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 右侧信息面板 -->
        <aside class="info-panel">
            <div class="panel">
                <h3><i class="fas fa-chart-pie"></i> 系统统计</h3>
                <div class="stats-grid">
                    <div class="stat-item">
                        <div class="stat-number" id="total-tables">22</div>
                        <div class="stat-label">数据表总数</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number" id="total-fields">0</div>
                        <div class="stat-label">字段总数</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number" id="total-relationships">28</div>
                        <div class="stat-label">关系连接</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number" id="total-modules">5</div>
                        <div class="stat-label">核心模块</div>
                    </div>
                </div>
            </div>

            <div class="panel">
                <h3><i class="fas fa-filter"></i> 视图控制</h3>
                <div class="controls">
                    <div class="control-group">
                        <label>显示模块</label>
                        <div class="checkbox-group">
                            <label class="checkbox-item">
                                <input type="checkbox" id="showUser" checked>
                                <span>用户权限</span>
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" id="showSchool" checked>
                                <span>学校组织</span>
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" id="showHomework" checked>
                                <span>作业管理</span>
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" id="showKnowledge" checked>
                                <span>知识图谱</span>
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" id="showRecommendation" checked>
                                <span>智能推荐</span>
                            </label>
                        </div>
                    </div>

                    <div class="control-group">
                        <label>显示关系</label>
                        <div class="checkbox-group">
                            <label class="checkbox-item">
                                <input type="checkbox" id="showPrimaryKeys" checked>
                                <span>主键关系</span>
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" id="showForeignKeys" checked>
                                <span>外键关系</span>
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" id="showLabels" checked>
                                <span>关系标签</span>
                            </label>
                        </div>
                    </div>

                    <div class="control-group">
                        <label>布局算法</label>
                        <select id="layoutSelect" class="select-control">
                            <option value="hierarchical">层次布局</option>
                            <option value="force">力导向布局</option>
                            <option value="circular">环形布局</option>
                            <option value="grid">网格布局</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="panel">
                <h3><i class="fas fa-search"></i> 搜索表</h3>
                <div class="search-container">
                    <input type="text" id="tableSearch" placeholder="搜索表名或字段..." class="search-input">
                    <button id="searchBtn" class="btn btn-primary">
                        <i class="fas fa-search"></i>
                    </button>
                </div>
                <div id="searchResults" class="search-results">
                    <!-- 搜索结果 -->
                </div>
            </div>
        </aside>
    </main>

    <!-- 底部状态栏 -->
    <footer class="footer">
        <div class="footer-content">
            <div class="status-info">
                <span id="selectedTable">未选择表</span>
                <span class="separator">|</span>
                <span id="connectionCount">连接数: 0</span>
                <span class="separator">|</span>
                <span id="zoomLevel">缩放: 100%</span>
            </div>
            <div class="footer-actions">
                <button id="exportBtn" class="btn btn-outline">
                    <i class="fas fa-download"></i> 导出图表
                </button>
                <button id="fullscreenBtn" class="btn btn-outline">
                    <i class="fas fa-expand"></i> 全屏
                </button>
            </div>
        </div>
    </footer>



    <!-- JavaScript -->
    <script src="data.js"></script>
    <script src="database-api.js"></script>
    <script src="visualization.js"></script>
    <script src="interactions.js"></script>
</body>
</html>
